{"version":3,"file":"DiffWidget.js","sourceRoot":"./@jupyterlab/git/src/","sources":["components/diff/DiffWidget.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,WAAW,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAC;AAC/D,OAAO,EAAE,OAAO,EAAE,MAAM,uBAAuB,CAAC;AAEhD,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAE/B,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC7C,OAAO,EAAE,IAAI,EAAE,eAAe,EAAE,kBAAkB,EAAE,MAAM,QAAQ,CAAC;AACnE,OAAO,EAAE,WAAW,EAAgB,MAAM,SAAS,CAAC;AAEpD;;;;;;;;;GASG;AACH,MAAM,CAAC,KAAK,UAAU,YAAY,CAChC,QAAgB,EAChB,KAAmB,EACnB,WAAyB,EACzB,UAA+B,EAC/B,MAAM,GAAG,KAAK;IAEd,IAAI,eAAe,CAAC,QAAQ,CAAC,IAAI,MAAM,EAAE;QACvC,MAAM,EAAE,GAAG,UAAU,QAAQ,IAAI,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,EAAE,CAAC;QACvE,MAAM,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAClD,IAAI,YAAY,GAAG,aAAa,CAAC,IAAI,EAAE,CAAC;QACxC,OAAO,YAAY,EAAE;YACnB,IAAI,YAAY,CAAC,EAAE,KAAK,EAAE,EAAE;gBAC1B,KAAK,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC7B,MAAM;aACP;YACD,YAAY,GAAG,aAAa,CAAC,IAAI,EAAE,CAAC;SACrC;QACD,IAAI,CAAC,YAAY,EAAE;YACjB,MAAM,cAAc,GAAG,KAAK,CAAC,mBAAmB,EAAE,CAAC;YACnD,MAAM,YAAY,GAAG,WAAW,CAAC,MAAM,CACrC,oBAAC,kBAAkB,IAAC,KAAK,EAAE,UAAU;gBACnC,oBAAC,IAAI,IACH,IAAI,EAAE,QAAQ,EACd,WAAW,EAAE,WAAW,EACxB,WAAW,EAAE,cAAc,GAC3B,CACiB,CACtB,CAAC;YACF,YAAY,CAAC,EAAE,GAAG,EAAE,CAAC;YACrB,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACtD,YAAY,CAAC,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;YACnC,YAAY,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;YACnC,YAAY,CAAC,QAAQ,CAAC,gCAAgC,CAAC,CAAC;YAExD,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;YACtC,KAAK,CAAC,KAAK,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;SAC3C;KACF;SAAM;QACL,UAAU,CAAC;YACT,KAAK,EAAE,oBAAoB;YAC3B,IAAI,EAAE,6BAA6B,OAAO,CAAC,OAAO,CAChD,QAAQ,CACT,CAAC,iBAAiB,EAAE,SAAS;SAC/B,CAAC,CAAC;KACJ;AACH,CAAC","sourcesContent":["import { ReactWidget, showDialog } from '@jupyterlab/apputils';\nimport { PathExt } from '@jupyterlab/coreutils';\nimport { IRenderMimeRegistry } from '@jupyterlab/rendermime';\nimport * as React from 'react';\nimport { GitExtension } from '../../model';\nimport { diffIcon } from '../../style/icons';\nimport { Diff, isDiffSupported, RenderMimeProvider } from './Diff';\nimport { getRefValue, IDiffContext } from './model';\n\n/**\n * Method to open a main menu panel to show the diff of a given Notebook file.\n * If one already exists, just activates the existing one.\n *\n * @param filePath the path relative to the Git repo root.\n * @param shell The JupyterLab shell instance\n * @param diffContext the context in which the diff is being requested\n * @param renderMime the renderMime registry instance from the\n * @param isText Is the file of textual type?\n */\nexport async function openDiffView(\n  filePath: string,\n  model: GitExtension,\n  diffContext: IDiffContext,\n  renderMime: IRenderMimeRegistry,\n  isText = false\n) {\n  if (isDiffSupported(filePath) || isText) {\n    const id = `nbdiff-${filePath}-${getRefValue(diffContext.currentRef)}`;\n    const mainAreaItems = model.shell.widgets('main');\n    let mainAreaItem = mainAreaItems.next();\n    while (mainAreaItem) {\n      if (mainAreaItem.id === id) {\n        model.shell.activateById(id);\n        break;\n      }\n      mainAreaItem = mainAreaItems.next();\n    }\n    if (!mainAreaItem) {\n      const serverRepoPath = model.getRelativeFilePath();\n      const nbDiffWidget = ReactWidget.create(\n        <RenderMimeProvider value={renderMime}>\n          <Diff\n            path={filePath}\n            diffContext={diffContext}\n            topRepoPath={serverRepoPath}\n          />\n        </RenderMimeProvider>\n      );\n      nbDiffWidget.id = id;\n      nbDiffWidget.title.label = PathExt.basename(filePath);\n      nbDiffWidget.title.icon = diffIcon;\n      nbDiffWidget.title.closable = true;\n      nbDiffWidget.addClass('jp-git-diff-parent-diff-widget');\n\n      model.shell.add(nbDiffWidget, 'main');\n      model.shell.activateById(nbDiffWidget.id);\n    }\n  } else {\n    showDialog({\n      title: 'Diff Not Supported',\n      body: `Diff is not supported for ${PathExt.extname(\n        filePath\n      ).toLocaleLowerCase()} files.`\n    });\n  }\n}\n"]}